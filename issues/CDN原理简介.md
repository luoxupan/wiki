## 简介

内容分发网络（Content Delivery Network，简称CDN）是建立并覆盖在承载网之上、由分布在不同区域的边缘节点服务器群共同组成的分布式网络，替代以Web Server为中心的传统数据传输模式。

CDN的工作原理就是将您源站的资源缓存到各地的边缘节点服务器（CDN节点）上，用户请求访问和获取资源时，就近调用CDN节点上缓存的资源。这种分布式数据传输方式，使得用户请求的资源不需要都回您的源站获取，从而避免网络拥塞、分担源站压力，保证用户访问资源的速度和体验。

## 架构图

使用CDN后的http请求处理流程如下图

![image](https://user-images.githubusercontent.com/7278711/125550998-ae24078e-c574-440b-aece-79ac9413eef1.png)

1. 当终端用户（北京）向www.a.com下的某资源发起请求时，首先向LDNS（本地DNS）发起域名解析请求。
2. LDNS检查缓存中是否有www.a.com的IP地址记录。如果有，则直接返回给终端用户；如果没有，则向授权DNS查询。
3. 当授权DNS解析www.a.com时，返回域名CNAME www.a.tbcdn.com对应IP地址。
4. 域名解析请求发送至阿里云DNS调度系统，并为请求分配最佳节点IP地址。
5. LDNS获取DNS返回的解析IP地址。
6. 用户获取解析IP地址。
7. 用户向获取的IP地址发起对该资源的访问请求。

   1.   如果该IP地址对应的节点已缓存该资源，则会将数据直接返回给用户，例如，图中步骤7和8，请求结束。 
   2.   如果该IP地址对应的节点未缓存该资源，则节点向源站发起对该资源的请求。获取资源后，结合用户自定义配置的缓存策略，将资源缓存至节点，例如，图中的北京节点，并返回给用户，请求结束。配置缓存策略的操作方法，请参见[缓存配置](https://help.aliyun.com/document_detail/27136.html#concept-f24-32d-xdb)。

## 功能介绍

### 节点缓存

- 精准缓存，分层缓存HOT资源，实现资源精准加速。
- 高速缓存，均衡使用CPU多核处理能力，高效合理使用和控制内存，最大化SSD IOPS和吞吐。
- 高速读写，各节点具备高速读写固态硬盘SSD存储，配合SSD加速能力，大幅减少用户访问等待时间，提高可用性。
- 智能压缩，有效减少用户传输内容大小，加速分发效果。
- 页面优化，去除页面冗余内容，减少页面的大小。组合多个JavaScript/CSS文件成为一个请求。

### 精准调度

- 站点类型全覆盖，支持各类网站和移动应用类App，针对性业务支持，全面站点提速。
- 智能调度系统，自主研发，单机支持百万级别域名调度。
- 可控可扩展，更加优异的可控性、协议扩展性，进一步降低成本。
- 多级调度，节点故障不会造成用户不可用。
- 多系统联动，与安全防御系统、刷新系统、内容管理系统等协调工作。
- 数据化实时调度，支持节点级别流量预测，提升调度质量和准确性。


# CDN手动接口刷新

### 注意事项：

1. **只有文件名不变内容发生变化的情况才需要刷新（新上传的不需要刷新）**
2. http和https对应CDN来说是两个路径，所以都需要刷新
3. 刷新的url可以是目录，如果是目录必须以/结尾。
4. 返回结果的code为0表示成功；非0表示失败，err为对应的失败报错
5. CDN刷新次数有上限，所以尽量限制刷新频率
